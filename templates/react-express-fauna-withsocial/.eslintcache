[{"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/index.js":"1","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/App.js":"2","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/reportWebVitals.js":"3","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/home.js":"4","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/profile.js":"5","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/login.js":"6","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/callback.js":"7","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/layout.js":"8","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/social-logins.js":"9","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/form.js":"10","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/lib/hooks.js":"11","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/header.js":"12"},{"size":500,"mtime":1607709431501,"results":"13","hashOfConfig":"14"},{"size":595,"mtime":1607709431492,"results":"15","hashOfConfig":"14"},{"size":362,"mtime":1607709431503,"results":"16","hashOfConfig":"14"},{"size":284,"mtime":1607709431495,"results":"17","hashOfConfig":"14"},{"size":388,"mtime":1607709431497,"results":"18","hashOfConfig":"14"},{"size":2354,"mtime":1607709431497,"results":"19","hashOfConfig":"14"},{"size":2947,"mtime":1607709431493,"results":"20","hashOfConfig":"14"},{"size":1156,"mtime":1607709431496,"results":"21","hashOfConfig":"14"},{"size":1632,"mtime":1607709431498,"results":"22","hashOfConfig":"14"},{"size":2455,"mtime":1607709431494,"results":"23","hashOfConfig":"14"},{"size":1017,"mtime":1607709431502,"results":"24","hashOfConfig":"14"},{"size":1386,"mtime":1607709431495,"results":"25","hashOfConfig":"14"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},"3pr8nz",{"filePath":"29","messages":"30","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"35","messages":"36","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"37","messages":"38","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"41","usedDeprecatedRules":"28"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"44","messages":"45","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"50","usedDeprecatedRules":"28"},{"filePath":"51","messages":"52","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/index.js",[],["53","54"],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/App.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/reportWebVitals.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/home.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/profile.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/login.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/callback.js",["55","56"],"import { useState, useEffect } from 'react';\nimport Layout from './layout';\nimport { Magic } from 'magic-sdk';\nimport { OAuthExtension } from '@magic-ext/oauth';\n\nconst Callback = (props) => {\n  const [magic, setMagic] = useState(null);\n  const [errorMsg, setErrorMsg] = useState('');\n  const [showNextStep, setShowNextStep] = useState(false);\n\n  let providerParam;\n  let magicCredentialParam;\n\n  useEffect(() => {\n    const params = new URLSearchParams(props.location.search);\n    providerParam = params.get('provider');\n    magicCredentialParam = params.get('magic_credential');\n    !magic &&\n      setMagic(\n        new Magic(process.env.REACT_APP_MAGIC_PUBLISHABLE_KEY, {\n          extensions: [new OAuthExtension()],\n        })\n      );\n    console.log(magic && providerParam);\n    if (magic) {\n      providerParam ? finishSocialLogin() : finishEmailRedirectLogin();\n    }\n  }, [magic, props.location.search]);\n\n  const finishSocialLogin = async () => {\n    try {\n      let {\n        magic: { idToken },\n      } = await magic.oauth.getRedirectResult();\n      setShowNextStep(true);\n      const res = await authenticateWithServer(idToken);\n      res.status === 200 && props.history.push('/');\n    } catch (error) {\n      console.error('An unexpected error happened occurred:', error);\n      setErrorMsg('Error logging in. Please try again.');\n    }\n  };\n\n  const finishEmailRedirectLogin = async () => {\n    if (magicCredentialParam) {\n      try {\n        let didToken = await magic.auth.loginWithCredential();\n        setShowNextStep(true);\n        let res = await authenticateWithServer(didToken);\n        res.status === 200 && props.history.push('/');\n      } catch (error) {\n        console.error('An unexpected error happened occurred:', error);\n        setErrorMsg('Error logging in. Please try again.');\n      }\n    }\n  };\n\n  const authenticateWithServer = async (didToken) => {\n    return await fetch(`${process.env.REACT_APP_SERVER_URL}/api/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + didToken,\n      },\n      credentials: 'include',\n    });\n  };\n\n  return (\n    <Layout>\n      {!errorMsg ? (\n        <div className='callback-container'>\n          <div style={{ margin: '25px 0' }}>Retrieving auth token...</div>\n          {showNextStep && <div style={{ margin: '25px 0' }}>Validating token...</div>}\n        </div>\n      ) : (\n        <div className='error'>{errorMsg}</div>\n      )}\n\n      <style>{`\n        .login {\n          max-width: 21rem;\n          margin: 0 auto;\n          padding: 1rem;\n          border: 1px solid #ccc;\n          border-radius: 4px;\n        }\n        .error {\n          color: red;\n        }\n        .callback-container {\n          width: 100%;\n          text-align: center;\n        }\n        .mono {\n          font-family: monospace !important;\n        }\n      `}</style>\n    </Layout>\n  );\n};\n\nexport default Callback;\n","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/layout.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/social-logins.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/form.js",[],"/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/lib/hooks.js",["57"],"import { useEffect } from 'react';\nimport useSWR from 'swr';\nimport { useHistory } from 'react-router-dom';\n\nconst fetcher = (url) =>\n  fetch(url, {\n    method: 'GET',\n    credentials: 'include',\n  })\n    .then((r) => r.json())\n    .then((data) => {\n      return { user: data?.user || null };\n    });\n\nexport function useUser({ redirectTo, redirectIfFound } = {}) {\n  const history = useHistory();\n  const { data, error } = useSWR(`${process.env.REACT_APP_SERVER_URL}/api/user`, fetcher);\n  const user = data?.user;\n  const finished = Boolean(data);\n  const hasUser = Boolean(user);\n\n  useEffect(() => {\n    if (!redirectTo || !finished) return;\n    if (\n      // If redirectTo is set, redirect if the user was not found.\n      (redirectTo && !redirectIfFound && !hasUser) ||\n      // If redirectIfFound is also set, redirect if the user was found\n      (redirectIfFound && hasUser)\n    ) {\n      history.push(redirectTo);\n    }\n  }, [redirectTo, redirectIfFound, finished, hasUser]);\n  return error ? null : user;\n}\n","/Users/huntercote/Desktop/code/magic-personal/auth-only/magic-hackathon/templates/react-express-fauna-withsocial/src/components/header.js",[],{"ruleId":"58","replacedBy":"59"},{"ruleId":"60","replacedBy":"61"},{"ruleId":"62","severity":1,"message":"63","line":16,"column":21,"nodeType":"64","endLine":16,"endColumn":43},{"ruleId":"62","severity":1,"message":"65","line":17,"column":28,"nodeType":"64","endLine":17,"endColumn":58},{"ruleId":"62","severity":1,"message":"66","line":32,"column":6,"nodeType":"67","endLine":32,"endColumn":54,"suggestions":"68"},"no-native-reassign",["69"],"no-negated-in-lhs",["70"],"react-hooks/exhaustive-deps","Assignments to the 'providerParam' variable from inside React Hook useEffect will be lost after each render. To preserve the value over time, store it in a useRef Hook and keep the mutable value in the '.current' property. Otherwise, you can move this variable directly inside useEffect.","CallExpression","Assignments to the 'magicCredentialParam' variable from inside React Hook useEffect will be lost after each render. To preserve the value over time, store it in a useRef Hook and keep the mutable value in the '.current' property. Otherwise, you can move this variable directly inside useEffect.","React Hook useEffect has a missing dependency: 'history'. Either include it or remove the dependency array.","ArrayExpression",["71"],"no-global-assign","no-unsafe-negation",{"desc":"72","fix":"73"},"Update the dependencies array to be: [redirectTo, redirectIfFound, finished, hasUser, history]",{"range":"74","text":"75"},[934,982],"[redirectTo, redirectIfFound, finished, hasUser, history]"]